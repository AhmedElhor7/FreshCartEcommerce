import{u as G,r as i,C as z,W as O,s as c,b as P,j as e,R as H,H as J,L as K,_ as r,a as b}from"./index-CTMrPMac.js";import{S as _}from"./autoprefixer-if5DPhmf.js";const Q=()=>{const l=localStorage.getItem("productIds");return l?JSON.parse(l):[]};function ee(){var p,f,g,j,y,N,w,v;var l={dots:!0,infinite:!0,speed:500,slidesToShow:1,slidesToScroll:1,autoplay:!0,autoplaySpeed:3e3};const{id:m,category:S}=G(),{addProductToCart:A,cartItemsNo:B,setCartItemsNo:F}=i.useContext(z),{wishList:I,addProductToWishList:L,removeProductFromWishList:T}=i.useContext(O),[M,E]=i.useState(),[n,W]=i.useState(Q()),[x,o]=i.useState(!1),d=t=>I.includes(t);async function u(t){o(!0);try{if(n.includes(t)){r.error("Product is already added to the cart. If you need to increase the quantity, please go to the Cart"),o(!1);return}E(t);let a=await A(t);a.data.status==="success"?(W(C=>[...C,t]),F(a.data.numOfCartItems),o(!1),r.success(a.data.message,{duration:5e3,position:window.innerWidth<768?"top-center":"right-top",style:{height:"5rem"}})):(o(!1),r.error(a.data.message))}catch(a){console.error("Failed to add product:",a),r("Failed to add product.")}}i.useEffect(()=>{c(),localStorage.setItem("productIds",JSON.stringify(n))},[n]);function k(t){return b.get(`https://ecommerce.routemisr.com/api/v1/products/${t}`)}const{data:s,error:U,isError:V,isFetched:X,isLoading:q}=P({queryKey:["ProductDeatails",m],queryFn:()=>k(m)});function R(){return b.get("https://ecommerce.routemisr.com/api/v1/products")}const $=P({queryKey:["RelatedCategory"],queryFn:async()=>(await R()).data.data.filter(D=>D.category.name===S)});if(q)return e.jsx("div",{className:"w-full  h-screen flex justify-center items-center",children:e.jsx(H,{color:"green",size:150})});async function h(t){if(d(t)){let a=await T(t);a.data.status==="success"?r.success(a.data.message,{duration:5e3,position:window.innerWidth<768?"top-center":"right-top",style:{height:"5rem"}}):r.error(a.data.message||"Failed to remove from wishlist")}else{let a=await L(t);a.data.status==="success"?r.success(a.data.message,{duration:5e3,position:window.innerWidth<768?"top-center":"right-top",style:{height:"5rem"}}):r.error(a.data.message||"Failed to add to wishlist")}}return e.jsxs(e.Fragment,{children:[e.jsx(J,{children:e.jsx("title",{children:"Product Deatails"})}),e.jsxs("div",{className:"container mx-auto pt-5 lg:pt-28",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"w-full md:w-1/2 lg:w-1/4 px-4",children:e.jsx("div",{className:"md:pe-4 w-full",children:e.jsx(_,{...l,children:s==null?void 0:s.data.data.images.map(t=>e.jsx("img",{onClick:c,loading:"lazy",src:t,alt:s==null?void 0:s.data.data.title,className:"w-full"}))})})}),e.jsx("div",{className:"w-full md:w-1/2 lg:w-3/4 text-center md:text-start",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl leading-loose font-bold py-6",children:s==null?void 0:s.data.data.title}),e.jsx("h2",{className:" text-green-500 font-normal uppercase text-2xl py-2",children:(p=s==null?void 0:s.data.data)==null?void 0:p.category.name}),e.jsx("p",{children:(f=s==null?void 0:s.data.data)==null?void 0:f.description}),e.jsxs("div",{className:"flex justify-between items-center pt-6",children:[e.jsxs("span",{className:"font-medium line-through text-gray-500 text-xl",children:[((g=s==null?void 0:s.data.data)==null?void 0:g.price)+50," EGP"]}),e.jsxs("span",{className:"text-red-500 font-extrabold text-2xl",children:[(j=s==null?void 0:s.data.data)==null?void 0:j.price," EGP"]}),e.jsxs("span",{className:"text-2xl",children:[" ",e.jsx("i",{className:"fa-solid fa-star text-yellow-200"})," ",e.jsx("span",{children:(y=s==null?void 0:s.data.data)==null?void 0:y.ratingsAverage})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-6",children:[e.jsxs("button",{onClick:()=>{var t;return u((t=s==null?void 0:s.data.data)==null?void 0:t.id)},className:"btn btn-primary w-4/5",children:[e.jsx("i",{className:"fa-solid fa-cart-plus me-2"}),x?"Adding...":"Add to Cart"]}),e.jsx("button",{onClick:()=>{var t;return h((t=s==null?void 0:s.data.data)==null?void 0:t.id)},className:"cursor-pointer",children:e.jsx("i",{className:`fa-solid fa-heart text-3xl ${d((N=s==null?void 0:s.data.data)==null?void 0:N.id)?"text-red-500":"text-gray-500"}`})},(w=s==null?void 0:s.data.data)==null?void 0:w.id)]})]})})]}),e.jsx("div",{className:"row",children:(v=$.data)==null?void 0:v.map(t=>e.jsx("div",{onClick:c,className:"xl:w-1/4 md:w-1/2 p-4",children:e.jsx(K,{to:`/productsdetails/${t.id}/${t.category.name}`,children:e.jsxs("div",{className:"product hover:shadow-2xl hover:shadow-green-500 px-4",children:[e.jsx("div",{children:e.jsx("img",{loading:"lazy",src:t.imageCover,alt:t.title,className:"w-full"})}),e.jsx("p",{className:"font-normal text-green-500 uppercase py-2",children:t.category.name}),e.jsx("h3",{className:"font-extrabold uppercase",children:t.title.split(" ",2).join(" ")}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-medium line-through text-gray-500 text-xl",children:[t.price+50," EGP"]}),e.jsxs("span",{className:"text-red-500 font-extrabold",children:[t.price," EGP"]}),e.jsxs("span",{className:"text-xl",children:[" ",e.jsx("i",{className:"fa-solid fa-star text-yellow-200"})," ",e.jsx("span",{children:t.ratingsAverage})]})]}),e.jsxs("div",{className:"flex justify-between items-center py-4",children:[e.jsxs("button",{onClick:()=>u(t.id),className:"btn btn-primary",children:[e.jsx("i",{className:"fa-solid fa-cart-plus me-2"}),x?"Adding...":"Add to Cart"]}),e.jsx("button",{onClick:()=>h(t.id),className:"cursor-pointer",children:e.jsx("i",{className:`fa-solid fa-heart text-3xl ${d(t.id)?"text-red-500":"text-gray-500"}`})},t.id)]})]})})},t.id))})]})]})}export{ee as default};
