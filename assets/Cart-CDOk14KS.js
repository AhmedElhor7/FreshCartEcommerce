import{r as s,C as O,j as e,H as D,L as N,_ as l,h as T}from"./index-yb_qZEUF.js";const E=()=>{const o=localStorage.getItem("productIds");return o?JSON.parse(o):[]};function H(){var j,C;const{data:o,cartData:w,updateCartItemCount:k,deleteItemFromCart:v,deleteAllCart:I,setCartItemsNo:d}=s.useContext(O),[S,m]=s.useState(!1),[A,u]=s.useState(!1),[f,g]=s.useState(!1),[h,y]=s.useState(),[r,i]=s.useState(),[M,p]=s.useState(E());s.useEffect(()=>{i(o.data.data)},[w]);async function b(t,a){y(t),m(!0);let n=await k(t,a);i(n.data.data),n.data.status==="success"?(d(n.data.numOfCartItems),p(c=>{const x=c.filter(L=>L!==t);return localStorage.setItem("productIds",JSON.stringify(x)),x}),l.success("Quantity updated successfully",{duration:5e3,position:window.innerWidth<768?"top-center":"right-top",style:{height:"5rem"}}),m(!1)):(l.error("Faild Update Quantity"),m(!1))}async function F(t){y(t),console.log(h,t),u(!0);let a=await v(t);i(a.data.data),a.data.status==="success"?(T(t),d(a.data.numOfCartItems),p(n=>{const c=n.filter(x=>x!==t);return localStorage.setItem("productIds",JSON.stringify(c)),c}),l.success("Item Deleted successfully",{duration:5e3,position:window.innerWidth<768?"top-center":"right-top",style:{height:"5rem"}}),u(!1)):(l.error("Faild Delete Item"),u(!1))}async function P(){g(!0);let t=await I();i(t.data.data),t.statusText==="OK"?(localStorage.removeItem("productIds"),d(0),p([]),localStorage.removeItem("productIds"),l.success("All Cart Deleted successfully",{duration:5e3,position:window.innerWidth<768?"top-center":"right-top",style:{height:"5rem"}}),g(!1)):(l.error("Faild Delete All Cart"),g(!1))}return((j=r==null?void 0:r.products)==null?void 0:j.length)===0&&d(0),e.jsxs(e.Fragment,{children:[e.jsx(D,{children:e.jsx("title",{children:"Cart"})}),e.jsx("h2",{className:"text-4xl font-bold text-green-600 flex items-center justify-center pb-2 2xl:mt-28 ",children:"Shopping Cart"}),(r==null?void 0:r.products.length)===0?e.jsxs("div",{id:"alert-border-3",className:"flex items-center p-6 mt-5   mb-4 text-green-800 border-t-4 border-green-300 bg-green-50 dark:text-green-400 dark:bg-gray-800 dark:border-green-800",role:"alert",children:[e.jsx("svg",{className:"flex-shrink-0 w-4 h-4","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"})}),e.jsxs("div",{className:"ms-3 text-xl font-bold",children:["Your cart is empty. Please add some products to proceed.","",e.jsx("a",{href:"#",className:"font-bold ps-6 underline hover:no-underline text-lg text-green-600",children:e.jsx(N,{to:"/",children:"Go To Home To Add Products"})})]}),e.jsx("button",{type:"button",className:"ms-auto -mx-1.5 -my-1.5 bg-green-50 text-green-500 rounded-lg focus:ring-2 focus:ring-green-400 p-1.5 hover:bg-green-200 inline-flex items-center justify-center h-8 w-8 dark:bg-gray-800 dark:text-green-400 dark:hover:bg-gray-700","data-dismiss-target":"#alert-border-3","aria-label":"Close"})]}):e.jsxs("div",{className:"relative overflow-auto shadow-md sm:rounded-lg container mx-auto w-full lg:w-9/12 text-center pt-10",children:[e.jsx("h3",{className:"pb-2 flex items-center justify-center pt-2",children:e.jsxs("span",{className:"text-3xl",children:[" ","Total Cart Price : ",r==null?void 0:r.totalCartPrice," EGP"]})}),e.jsx("h4",{className:"pb-8 flex items-center justify-center pt-4",children:e.jsxs("span",{className:"text-3xl",children:[" ","Total Cart Items : ",r==null?void 0:r.products.length]})}),e.jsxs("table",{className:"text-sm w-full text-left rtl:text-right text-gray-500 dark:text-gray-400 ",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-16 py-3",children:e.jsx("span",{className:"sr-only",children:"Image"})}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Product"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Quantity"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Price"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Action"})]})}),e.jsx("tbody",{children:(C=r==null?void 0:r.products)==null?void 0:C.map((t,a)=>e.jsxs("tr",{className:`bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 ${a%2===0?"bg-white dark:bg-gray-800":"bg-gray-300 dark:bg-gray-700"}`,children:[e.jsx("td",{className:"p-4",children:e.jsx("img",{src:t.product.imageCover,className:"w-16 md:w-32 max-w-full max-h-full",alt:t.product.title})}),e.jsx("td",{className:"px-6 py-4 font-semibold text-gray-900 dark:text-white",children:t.totalCartPrice}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center",children:h===t.product.id&&S?e.jsx("i",{className:"fas fa-spinner fa-spin text-3xl text-green-500"}):e.jsxs(e.Fragment,{children:[" ",e.jsxs("button",{onClick:()=>b(t.product.id,t.count-1),className:"inline-flex items-center justify-center p-1 me-3 text-sm font-medium h-6 w-6 text-gray-500 bg-white border border-gray-300 rounded-full focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",type:"button",children:[e.jsx("span",{className:"sr-only",children:"Quantity button"}),e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 18 2",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M1 1h16"})})]}),e.jsx("div",{children:e.jsx("span",{className:"font-bold text-xl",children:t.count})}),e.jsxs("button",{onClick:()=>b(t.product.id,t.count+1),className:"inline-flex items-center justify-center h-6 w-6 p-1 ms-3 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-full focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",type:"button",children:[e.jsx("span",{className:"sr-only",children:"Quantity button"}),e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 18 18",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 1v16M1 9h16"})})]})]})})}),e.jsxs("td",{className:"px-6 py-4 font-bold text-gray-900 dark:text-white",children:[t.price," EGP"]}),e.jsx("td",{className:"px-6 py-4",children:A&&h===t.product.id?e.jsx("i",{className:"fas fa-spinner fa-spin text-3xl text-green-500"}):e.jsx(e.Fragment,{children:e.jsx("span",{onClick:()=>F(t.product.id),className:"cursor-pointer font-bold text-red-600 dark:text-red-500 hover:underline",children:"Remove"})})})]},t._id))})]})]}),(r==null?void 0:r.products.length)>0?e.jsxs("div",{children:[e.jsx(N,{to:`/checkout/${r._id}`,children:e.jsx("div",{className:"flex justify-center items-center pt-12",children:e.jsx("button",{className:"btn btn-primary w-9/12",children:e.jsx("span",{className:"text-xl font-semibold",children:" CheckOut "})})})}),e.jsx("div",{className:"flex justify-center items-center py-10",children:e.jsx("button",{onClick:P,className:"btn btn-red sm:w-2/3 md:w-2/4",disabled:f,children:f?e.jsx("i",{className:"fas fa-spinner fa-spin text-3xl text-green-500"}):e.jsx("span",{className:"font-semibold text-lg",children:"Clear All Cart"})})})]}):null]})}export{H as default};
